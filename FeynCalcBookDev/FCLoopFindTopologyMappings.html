<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>FeynCalc manual (development version)</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="css/feyncalc.css" />
  <script defer="" src="js/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: true
   });
}}});
  </script>
  <link rel="stylesheet" href="js/katex.min.css" />

</head>
<body>
<header id="title-block-header">
<h1 class="title">FeynCalc manual (development version)</h1>
</header>
<h2 id="fcloopfindtopologymappings">FCLoopFindTopologyMappings</h2>
<p><code>FCLoopFindTopologyMappings[{topo1, topo2, ...}]</code> finds
mappings between topologies (written as <code>FCTopology</code> objects)
<code>topo1, topo2, ...</code>. For each source topology the function
returns a list of loop momentum shifts and a <code>GLI</code>
replacement rule needed to map it to the given target topology. If you
need to map everything to a particular set of target topologies, you can
specify them via the <code>PreferredTopologies</code> option.</p>
<p>The output is a list of two lists, the former containing the mappings
and the latter enumerating the final contributing topologies</p>
<p>To enable shifts in the external momenta you need to set the option
<code>Momentum</code> to <code>All</code>.</p>
<h3 id="see-also">See also</h3>
<p><a href="Extra/FeynCalc.html">Overview</a>, <a
href="FCTopology.html">FCTopology</a>, <a href="GLI.html">GLI</a>, <a
href="FCLoopFindTopologies.html">FCLoopFindTopologies</a>.</p>
<h3 id="examples">Examples</h3>
<p>Here we have a set of 5 topologies</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>topos1 <span class="ex">=</span> <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    FCTopology<span class="op">[</span>fctopology1<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p2 <span class="sc">+</span> p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p2 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p1 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p2 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>p1<span class="op">,</span> p2<span class="op">,</span> p3<span class="op">},</span> <span class="op">{</span><span class="fu">Q</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    FCTopology<span class="op">[</span>fctopology2<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p2 <span class="sc">+</span> p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p2 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>p1<span class="op">,</span> p2<span class="op">,</span> p3<span class="op">},</span> <span class="op">{</span><span class="fu">Q</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    FCTopology<span class="op">[</span>fctopology3<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2 <span class="sc">+</span> p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p2 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>     <span class="op">{</span>p1<span class="op">,</span> p2<span class="op">,</span> p3<span class="op">},</span> <span class="op">{</span><span class="fu">Q</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    FCTopology<span class="op">[</span>fctopology4<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2 <span class="sc">+</span> p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>     <span class="op">{</span>p1<span class="op">,</span> p2<span class="op">,</span> p3<span class="op">},</span> <span class="op">{</span><span class="fu">Q</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    FCTopology<span class="op">[</span>fctopology5<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p3<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p2 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p1 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p2 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">-</span> <span class="fu">Q</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>     <span class="op">{</span>p1<span class="op">,</span> p2<span class="op">,</span> p3<span class="op">},</span> <span class="op">{</span><span class="fu">Q</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}]}</span>;</span></code></pre></div>
<p>3 of them can be mapped to the other two</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mappings1 <span class="ex">=</span> FCLoopFindTopologyMappings<span class="op">[</span>topos1<span class="op">]</span>;</span></code></pre></div>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Found }3\text{ mapping relations }</span></p>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Final number of independent topologies: }2</span></p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mappings1<span class="op">[[</span><span class="dv">1</span><span class="op">]]</span></span></code></pre></div>
<p><span class="math display">\left(
\begin{array}{ccc}
\;\text{FCTopology}\left(\text{fctopology3},\left\{\frac{1}{(\text{p3}^2+i
\eta )},\frac{1}{(\text{p2}^2+i \eta )},\frac{1}{(\text{p1}^2+i \eta
)},\frac{1}{((\text{p2}+\text{p3})^2+i \eta
)},\frac{1}{((\text{p1}+\text{p3})^2+i \eta
)},\frac{1}{((\text{p2}-Q)^2+i \eta
)},\frac{1}{((\text{p2}+\text{p3}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p3}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p2}+\text{p3}-Q)^2+i \eta
)}\right\},\{\text{p1},\text{p2},\text{p3}\},\{Q\},\{\},\{\}\right)
&amp; \{\text{p1}\to -\text{p1}-\text{p3}+Q,\text{p2}\to
-\text{p2}-\text{p3}+Q,\text{p3}\to \;\text{p3}\} &amp;
G^{\text{fctopology3}}(\text{n1$\_$},\text{n7$\_$},\text{n8$\_$},\text{n5$\_$},\text{n6$\_$},\text{n4$\_$},\text{n2$\_$},\text{n3$\_$},\text{n9$\_$}):\to
G^{\text{fctopology1}}(\text{n1},\text{n2},\text{n3},\text{n4},\text{n5},\text{n6},\text{n7},\text{n8},\text{n9})
\\
\;\text{FCTopology}\left(\text{fctopology4},\left\{\frac{1}{(\text{p3}^2+i
\eta )},\frac{1}{(\text{p2}^2+i \eta )},\frac{1}{(\text{p1}^2+i \eta
)},\frac{1}{((\text{p2}+\text{p3})^2+i \eta
)},\frac{1}{((\text{p1}+\text{p3})^2+i \eta
)},\frac{1}{((\text{p2}-Q)^2+i \eta )},\frac{1}{((\text{p1}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p3}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p2}+\text{p3}-Q)^2+i \eta
)}\right\},\{\text{p1},\text{p2},\text{p3}\},\{Q\},\{\},\{\}\right)
&amp; \{\text{p1}\to Q-\text{p2},\text{p2}\to Q-\text{p1},\text{p3}\to
-\text{p3}\} &amp;
G^{\text{fctopology4}}(\text{n1$\_$},\text{n6$\_$},\text{n5$\_$},\text{n8$\_$},\text{n7$\_$},\text{n3$\_$},\text{n2$\_$},\text{n4$\_$},\text{n9$\_$}):\to
G^{\text{fctopology1}}(\text{n1},\text{n2},\text{n3},\text{n4},\text{n5},\text{n6},\text{n7},\text{n8},\text{n9})
\\
\;\text{FCTopology}\left(\text{fctopology5},\left\{\frac{1}{(\text{p3}^2+i
\eta )},\frac{1}{(\text{p2}^2+i \eta )},\frac{1}{(\text{p1}^2+i \eta
)},\frac{1}{((\text{p1}+\text{p3})^2+i \eta
)},\frac{1}{((\text{p2}-Q)^2+i \eta )},\frac{1}{((\text{p1}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p3}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p2}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p2}+\text{p3}-Q)^2+i \eta
)}\right\},\{\text{p1},\text{p2},\text{p3}\},\{Q\},\{\},\{\}\right)
&amp; \{\text{p1}\to \;\text{p2},\text{p2}\to \;\text{p1},\text{p3}\to
\;\text{p3}\} &amp;
G^{\text{fctopology5}}(\text{n1$\_$},\text{n3$\_$},\text{n2$\_$},\text{n4$\_$},\text{n6$\_$},\text{n5$\_$},\text{n7$\_$},\text{n8$\_$},\text{n9$\_$}):\to
G^{\text{fctopology2}}(\text{n1},\text{n2},\text{n3},\text{n4},\text{n5},\text{n6},\text{n7},\text{n8},\text{n9})
\\
\end{array}
\right)</span></p>
<p>And these are the final topologies</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mappings1<span class="op">[[</span><span class="dv">2</span><span class="op">]]</span></span></code></pre></div>
<p><span
class="math display">\left\{\text{FCTopology}\left(\text{fctopology1},\left\{\frac{1}{(\text{p3}^2+i
\eta )},\frac{1}{(\text{p2}^2+i \eta )},\frac{1}{(\text{p1}^2+i \eta
)},\frac{1}{((\text{p2}+\text{p3})^2+i \eta
)},\frac{1}{((\text{p2}-Q)^2+i \eta )},\frac{1}{((\text{p1}-Q)^2+i \eta
)},\frac{1}{((\text{p2}+\text{p3}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p3}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p2}+\text{p3}-Q)^2+i \eta
)}\right\},\{\text{p1},\text{p2},\text{p3}\},\{Q\},\{\},\{\}\right),\text{FCTopology}\left(\text{fctopology2},\left\{\frac{1}{(\text{p3}^2+i
\eta )},\frac{1}{(\text{p2}^2+i \eta )},\frac{1}{(\text{p1}^2+i \eta
)},\frac{1}{((\text{p2}+\text{p3})^2+i \eta
)},\frac{1}{((\text{p2}-Q)^2+i \eta )},\frac{1}{((\text{p1}-Q)^2+i \eta
)},\frac{1}{((\text{p2}+\text{p3}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p2}-Q)^2+i \eta
)},\frac{1}{((\text{p1}+\text{p2}+\text{p3}-Q)^2+i \eta
)}\right\},\{\text{p1},\text{p2},\text{p3}\},\{Q\},\{\},\{\}\right)\right\}</span></p>
<p>Here is another example</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>topos2 <span class="ex">=</span> <span class="op">{</span>FCTopology<span class="op">[</span>fctopology1<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>q1 <span class="sc">+</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span><span class="fu">p</span> <span class="sc">+</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span><span class="fu">p</span> <span class="sc">-</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{</span><span class="fu">p</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>   FCTopology<span class="op">[</span>fctopology2<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span><span class="fu">p</span> <span class="sc">+</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span><span class="fu">p</span> <span class="sc">-</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{</span><span class="fu">p</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>   FCTopology<span class="op">[</span>fctopology3<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span><span class="fu">p</span> <span class="sc">-</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span><span class="fu">p</span> <span class="sc">-</span> q1 <span class="sc">+</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{</span><span class="fu">p</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}]}</span></span></code></pre></div>
<p><span
class="math display">\left\{\text{FCTopology}\left(\text{fctopology1},\left\{\frac{1}{(\text{q2}^2+i
\eta )},\frac{1}{(\text{q1}^2+i \eta
)},\frac{1}{((\text{q1}+\text{q2})^2+i \eta
)},\frac{1}{((p+\text{q1})^2+i \eta )},\frac{1}{((p-\text{q2})^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right),\text{FCTopology}\left(\text{fctopology2},\left\{\frac{1}{(\text{q2}^2+i
\eta )},\frac{1}{(\text{q1}^2+i \eta )},\frac{1}{((p+\text{q2})^2+i \eta
)},\frac{1}{((p-\text{q1})^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right),\text{FCTopology}\left(\text{fctopology3},\left\{\frac{1}{(\text{q2}^2+i
\eta )},\frac{1}{(\text{q1}^2+i \eta )},\frac{1}{((p-\text{q1})^2+i \eta
)},\frac{1}{((p-\text{q1}+\text{q2})^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right)\right\}</span></p>
<p>Yet this time we have some preferred set of topologies and want to
match to them (if possible)</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>preferredTopos2 <span class="ex">=</span> <span class="op">{</span>FCTopology<span class="op">[</span>prop2L<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>q1 <span class="sc">-</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span><span class="sc">-</span><span class="fu">p</span> <span class="sc">+</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span><span class="sc">-</span><span class="fu">p</span> <span class="sc">+</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{</span><span class="fu">p</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>   FCTopology<span class="op">[</span>prop2LX1<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>q1 <span class="sc">-</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span><span class="sc">-</span><span class="fu">p</span> <span class="sc">+</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span><span class="sc">-</span><span class="fu">p</span> <span class="sc">+</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{</span><span class="fu">p</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>   FCTopology<span class="op">[</span>prop2LX3<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span><span class="sc">-</span><span class="fu">p</span> <span class="sc">+</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span><span class="sc">-</span><span class="fu">p</span> <span class="sc">+</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{</span><span class="fu">p</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>   FCTopology<span class="op">[</span>prop2LX15<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>q1 <span class="sc">-</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span><span class="sc">-</span><span class="fu">p</span> <span class="sc">+</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{</span><span class="fu">p</span><span class="op">},</span> <span class="op">{},</span> <span class="op">{}]}</span></span></code></pre></div>
<p><span
class="math display">\left\{\text{FCTopology}\left(\text{prop2L},\left\{\frac{1}{(\text{q1}^2+i
\eta )},\frac{1}{(\text{q2}^2+i \eta
)},\frac{1}{((\text{q1}-\text{q2})^2+i \eta
)},\frac{1}{((\text{q1}-p)^2+i \eta )},\frac{1}{((\text{q2}-p)^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right),\text{FCTopology}\left(\text{prop2LX1},\left\{\frac{1}{(\text{q2}^2+i
\eta )},\frac{1}{((\text{q1}-\text{q2})^2+i \eta
)},\frac{1}{((\text{q1}-p)^2+i \eta )},\frac{1}{((\text{q2}-p)^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right),\text{FCTopology}\left(\text{prop2LX3},\left\{\frac{1}{(\text{q1}^2+i
\eta )},\frac{1}{(\text{q2}^2+i \eta )},\frac{1}{((\text{q1}-p)^2+i \eta
)},\frac{1}{((\text{q2}-p)^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right),\text{FCTopology}\left(\text{prop2LX15},\left\{\frac{1}{(\text{q2}^2+i
\eta )},\frac{1}{((\text{q1}-\text{q2})^2+i \eta
)},\frac{1}{((\text{q1}-p)^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right)\right\}</span></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mappings2 <span class="ex">=</span> FCLoopFindTopologyMappings<span class="op">[</span>topos2<span class="op">,</span> PreferredTopologies <span class="ot">-&gt;</span> preferredTopos2<span class="op">]</span>;</span></code></pre></div>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Found }3\text{ mapping relations }</span></p>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Final number of independent topologies: }3</span></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mappings2<span class="op">[[</span><span class="dv">1</span><span class="op">]]</span></span></code></pre></div>
<p><span class="math display">\left(
\begin{array}{ccc}
\;\text{FCTopology}\left(\text{fctopology1},\left\{\frac{1}{(\text{q2}^2+i
\eta )},\frac{1}{(\text{q1}^2+i \eta
)},\frac{1}{((\text{q1}+\text{q2})^2+i \eta
)},\frac{1}{((p+\text{q1})^2+i \eta )},\frac{1}{((p-\text{q2})^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right) &amp;
\{\text{q1}\to -\text{q2},\text{q2}\to \;\text{q1}\} &amp;
G^{\text{fctopology1}}(\text{n1$\_$},\text{n2$\_$},\text{n3$\_$},\text{n5$\_$},\text{n4$\_$}):\to
G^{\text{prop2L}}(\text{n1},\text{n2},\text{n3},\text{n4},\text{n5}) \\
\;\text{FCTopology}\left(\text{fctopology2},\left\{\frac{1}{(\text{q2}^2+i
\eta )},\frac{1}{(\text{q1}^2+i \eta )},\frac{1}{((p+\text{q2})^2+i \eta
)},\frac{1}{((p-\text{q1})^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right) &amp;
\{\text{q1}\to \;\text{q2},\text{q2}\to -\text{q1}\} &amp;
G^{\text{fctopology2}}(\text{n1$\_$},\text{n2$\_$},\text{n3$\_$},\text{n4$\_$}):\to
G^{\text{prop2LX3}}(\text{n1},\text{n2},\text{n3},\text{n4}) \\
\;\text{FCTopology}\left(\text{fctopology3},\left\{\frac{1}{(\text{q2}^2+i
\eta )},\frac{1}{(\text{q1}^2+i \eta )},\frac{1}{((p-\text{q1})^2+i \eta
)},\frac{1}{((p-\text{q1}+\text{q2})^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right) &amp;
\{\text{q1}\to \;\text{q2},\text{q2}\to \;\text{q2}-\text{q1}\} &amp;
G^{\text{fctopology3}}(\text{n2$\_$},\text{n1$\_$},\text{n4$\_$},\text{n3$\_$}):\to
G^{\text{prop2LX1}}(\text{n1},\text{n2},\text{n3},\text{n4}) \\
\end{array}
\right)</span></p>
<p>And these are the final occurring topologies</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mappings2<span class="op">[[</span><span class="dv">2</span><span class="op">]]</span></span></code></pre></div>
<p><span
class="math display">\left\{\text{FCTopology}\left(\text{prop2L},\left\{\frac{1}{(\text{q1}^2+i
\eta )},\frac{1}{(\text{q2}^2+i \eta
)},\frac{1}{((\text{q1}-\text{q2})^2+i \eta
)},\frac{1}{((\text{q1}-p)^2+i \eta )},\frac{1}{((\text{q2}-p)^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right),\text{FCTopology}\left(\text{prop2LX1},\left\{\frac{1}{(\text{q2}^2+i
\eta )},\frac{1}{((\text{q1}-\text{q2})^2+i \eta
)},\frac{1}{((\text{q1}-p)^2+i \eta )},\frac{1}{((\text{q2}-p)^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right),\text{FCTopology}\left(\text{prop2LX3},\left\{\frac{1}{(\text{q1}^2+i
\eta )},\frac{1}{(\text{q2}^2+i \eta )},\frac{1}{((\text{q1}-p)^2+i \eta
)},\frac{1}{((\text{q2}-p)^2+i \eta
)}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right)\right\}</span></p>
<p>If we need to match subtopologies into larger topologies, we first
need to generate all possible subtopologies for each relevant
topology.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>topos3 <span class="ex">=</span> <span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>   FCTopology<span class="op">[</span>fctopology1<span class="op">,</span> <span class="op">{</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">+</span> l2 <span class="sc">-</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span>SMP<span class="op">[</span><span class="st">&quot;m_t&quot;</span><span class="op">]</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span>SMP<span class="op">[</span><span class="st">&quot;m_t&quot;</span><span class="op">]</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l2 <span class="sc">+</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span>SMP<span class="op">[</span><span class="st">&quot;m_t&quot;</span><span class="op">]</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">-</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span>SMP<span class="op">[</span><span class="st">&quot;m_t&quot;</span><span class="op">]</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">-</span> q1 <span class="sc">-</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span>SMP<span class="op">[</span><span class="st">&quot;m_t&quot;</span><span class="op">]</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>l1<span class="op">,</span> l2<span class="op">},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{},</span> <span class="op">{}],</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>   FCTopology<span class="op">[</span>fctopology9<span class="op">,</span> <span class="op">{</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">+</span> l2 <span class="sc">+</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span>SMP<span class="op">[</span><span class="st">&quot;m_t&quot;</span><span class="op">]</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span>SMP<span class="op">[</span><span class="st">&quot;m_t&quot;</span><span class="op">]</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">+</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span>SMP<span class="op">[</span><span class="st">&quot;m_t&quot;</span><span class="op">]</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">-</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span>SMP<span class="op">[</span><span class="st">&quot;m_t&quot;</span><span class="op">]</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>l1<span class="op">,</span> l2<span class="op">},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{},</span> <span class="op">{}]</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>   <span class="op">}</span></span></code></pre></div>
<p><span
class="math display">\left\{\text{FCTopology}\left(\text{fctopology1},\left\{\frac{1}{((\text{l1}+\text{l2}-\text{q1})^2+i
\eta )},\frac{1}{(\text{l2}^2-m_t^2+i \eta
)},\frac{1}{(\text{l1}^2-m_t^2+i \eta
)},\frac{1}{((\text{l2}+\text{q2})^2-m_t^2+i \eta
)},\frac{1}{((\text{l1}-\text{q1})^2-m_t^2+i \eta
)},\frac{1}{((\text{l1}-\text{q1}-\text{q2})^2-m_t^2+i \eta
)}\right\},\{\text{l1},\text{l2}\},\{\text{q1},\text{q2}\},\{\},\{\}\right),\text{FCTopology}\left(\text{fctopology9},\left\{\frac{1}{((\text{l1}+\text{l2}+\text{q2})^2+i
\eta )},\frac{1}{(\text{l2}^2-m_t^2+i \eta
)},\frac{1}{(\text{l1}^2-m_t^2+i \eta
)},\frac{1}{((\text{l1}+\text{q2})^2-m_t^2+i \eta
)},\frac{1}{((\text{l1}-\text{q1})^2-m_t^2+i \eta
)}\right\},\{\text{l1},\text{l2}\},\{\text{q1},\text{q2}\},\{\},\{\}\right)\right\}</span></p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>subTopos3 <span class="ex">=</span> <span class="fu">Flatten</span><span class="op">[</span>FCLoopFindSubtopologies<span class="op">[</span>topos3<span class="op">]]</span>;</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>subTopos3 <span class="sc">//</span> <span class="fu">Length</span></span></code></pre></div>
<p><span class="math display">37</span></p>
<p>Now we can match a smaller topology into a larger topology</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mappings3 <span class="ex">=</span> FCLoopFindTopologyMappings<span class="op">[</span>topos3<span class="op">,</span> PreferredTopologies <span class="ot">-&gt;</span> subTopos3<span class="op">]</span>;</span></code></pre></div>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Found }1\text{ mapping relations }</span></p>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Final number of independent topologies: }1</span></p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mappings3<span class="op">[[</span><span class="dv">1</span><span class="op">]]</span></span></code></pre></div>
<p><span class="math display">\left(
\begin{array}{ccc}
\;\text{FCTopology}\left(\text{fctopology9},\left\{\frac{1}{((\text{l1}+\text{l2}+\text{q2})^2+i
\eta )},\frac{1}{(\text{l2}^2-m_t^2+i \eta
)},\frac{1}{(\text{l1}^2-m_t^2+i \eta
)},\frac{1}{((\text{l1}+\text{q2})^2-m_t^2+i \eta
)},\frac{1}{((\text{l1}-\text{q1})^2-m_t^2+i \eta
)}\right\},\{\text{l1},\text{l2}\},\{\text{q1},\text{q2}\},\{\},\{\}\right)
&amp; \{\text{l1}\to \;\text{q1}-\text{l1},\text{l2}\to
-\text{l2}-\text{q2}\} &amp;
G^{\text{fctopology9}}(\text{n1$\_$},\text{n3$\_$},\text{n4$\_$},\text{n5$\_$},\text{n2$\_$}):\to
G^{\text{fctopology1}}(\text{n1},0,\text{n2},\text{n3},\text{n4},\text{n5})
\\
\end{array}
\right)</span></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mappings3<span class="op">[[</span><span class="dv">2</span><span class="op">]]</span></span></code></pre></div>
<p><span
class="math display">\left\{\text{FCTopology}\left(\text{fctopology1},\left\{\frac{1}{((\text{l1}+\text{l2}-\text{q1})^2+i
\eta )},\frac{1}{(\text{l2}^2-m_t^2+i \eta
)},\frac{1}{(\text{l1}^2-m_t^2+i \eta
)},\frac{1}{((\text{l2}+\text{q2})^2-m_t^2+i \eta
)},\frac{1}{((\text{l1}-\text{q1})^2-m_t^2+i \eta
)},\frac{1}{((\text{l1}-\text{q1}-\text{q2})^2-m_t^2+i \eta
)}\right\},\{\text{l1},\text{l2}\},\{\text{q1},\text{q2}\},\{\},\{\}\right)\right\}</span></p>
<p>Mapping the following two topologies onto each other requires shifts
in the external momenta due to the chosen kinematic constraints.</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>topos4 <span class="ex">=</span> <span class="op">{</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>   FCTopology<span class="op">[</span>topo1<span class="op">,</span> <span class="op">{</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">+</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="fu">m</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">-</span> l2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l2 <span class="sc">+</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="fu">m</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l2 <span class="sc">-</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="fu">m</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>l1<span class="op">,</span> l2<span class="op">},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{</span>SPD<span class="op">[</span>q1<span class="op">,</span> q1<span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">0</span><span class="op">,</span> SPD<span class="op">[</span>q2<span class="op">,</span> q2<span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">0</span><span class="op">,</span> SPD<span class="op">[</span>q1<span class="op">,</span> q2<span class="op">]</span> <span class="ot">-&gt;</span> <span class="fu">s</span><span class="sc">/</span><span class="dv">2</span><span class="op">},</span> <span class="op">{}],</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>   FCTopology<span class="op">[</span>topo2<span class="op">,</span> <span class="op">{</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">-</span> l2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="fu">m</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l1 <span class="sc">-</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l2 <span class="sc">-</span> q2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="fu">m</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l2 <span class="sc">+</span> q1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="fu">m</span><span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>l2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>l1<span class="op">,</span> l2<span class="op">},</span> <span class="op">{</span>q1<span class="op">,</span> q2<span class="op">},</span> <span class="op">{</span>SPD<span class="op">[</span>q1<span class="op">,</span> q1<span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">0</span><span class="op">,</span> SPD<span class="op">[</span>q2<span class="op">,</span> q2<span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">0</span><span class="op">,</span> SPD<span class="op">[</span>q1<span class="op">,</span> q2<span class="op">]</span> <span class="ot">-&gt;</span> <span class="fu">s</span><span class="sc">/</span><span class="dv">2</span><span class="op">},</span> <span class="op">{}]}</span></span></code></pre></div>
<p><span
class="math display">\left\{\text{FCTopology}\left(\text{topo1},\left\{\frac{1}{((\text{l1}+\text{q1})^2-m^2+i
\eta )},\frac{1}{((\text{l1}-\text{l2})^2+i \eta
)},\frac{1}{((\text{l2}+\text{q1})^2-m^2+i \eta
)},\frac{1}{((\text{l2}-\text{q2})^2-m^2+i \eta
)},\frac{1}{(\text{l2}^2+i \eta
)}\right\},\{\text{l1},\text{l2}\},\{\text{q1},\text{q2}\},\left\{\text{q1}^2\to
0,\text{q2}^2\to 0,\text{q1}\cdot \;\text{q2}\to
\frac{s}{2}\right\},\{\}\right),\text{FCTopology}\left(\text{topo2},\left\{\frac{1}{((\text{l1}-\text{l2})^2-m^2+i
\eta )},\frac{1}{((\text{l1}-\text{q2})^2+i \eta
)},\frac{1}{((\text{l2}-\text{q2})^2-m^2+i \eta
)},\frac{1}{((\text{l2}+\text{q1})^2-m^2+i \eta
)},\frac{1}{(\text{l2}^2+i \eta
)}\right\},\{\text{l1},\text{l2}\},\{\text{q1},\text{q2}\},\left\{\text{q1}^2\to
0,\text{q2}^2\to 0,\text{q1}\cdot \;\text{q2}\to
\frac{s}{2}\right\},\{\}\right)\right\}</span></p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mappings4 <span class="ex">=</span> FCLoopFindTopologyMappings<span class="op">[</span>topos4<span class="op">,</span> Momentum <span class="ot">-&gt;</span> <span class="cn">All</span><span class="op">]</span>;</span></code></pre></div>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Found }1\text{ mapping relations }</span></p>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Final number of independent topologies: }1</span></p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mappings4<span class="op">[[</span><span class="dv">1</span><span class="op">]]</span></span></code></pre></div>
<p><span class="math display">\left(
\begin{array}{ccc}
\;\text{FCTopology}\left(\text{topo2},\left\{\frac{1}{((\text{l1}-\text{l2})^2-m^2+i
\eta )},\frac{1}{((\text{l1}-\text{q2})^2+i \eta
)},\frac{1}{((\text{l2}-\text{q2})^2-m^2+i \eta
)},\frac{1}{((\text{l2}+\text{q1})^2-m^2+i \eta
)},\frac{1}{(\text{l2}^2+i \eta
)}\right\},\{\text{l1},\text{l2}\},\{\text{q1},\text{q2}\},\left\{\text{q1}^2\to
0,\text{q2}^2\to 0,\text{q1}\cdot \;\text{q2}\to
\frac{s}{2}\right\},\{\}\right) &amp; \{\text{l1}\to
-\text{l1}+\text{l2}-\text{q1},\text{l2}\to \;\text{l2},\text{q1}\to
-\text{q2},\text{q2}\to -\text{q1}\} &amp;
G^{\text{topo2}}(\text{n1$\_$},\text{n2$\_$},\text{n3$\_$},\text{n4$\_$},\text{n5$\_$}):\to
G^{\text{topo1}}(\text{n1},\text{n2},\text{n3},\text{n4},\text{n5}) \\
\end{array}
\right)</span></p>
<p>Otherwise no mappings exist</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>FCLoopFindTopologyMappings<span class="op">[</span>topos4<span class="op">][[</span><span class="dv">1</span><span class="op">]]</span></span></code></pre></div>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Found }0\text{ mapping relations }</span></p>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Final number of independent topologies: }2</span></p>
<p><span class="math display">\{\}</span></p>
<p>Topologies containing eikonal or other nonstandard propagators may
introduce additional challenges. Even though two such topologies can be
recognized to be identical, the code still would not be able to work out
the correct momentum shifts without some additional input.</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>topoEik1 <span class="ex">=</span> FCTopology<span class="op">[</span>mytopo67<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>k2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>k1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>k1 <span class="sc">+</span> k2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span><span class="dv">0</span><span class="op">,</span> <span class="sc">-</span>k1 . nb<span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>k2<span class="op">,</span> <span class="sc">-</span>meta u0b k2 . nb<span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>k1 <span class="sc">+</span> k2<span class="op">,</span> <span class="sc">-</span><span class="dv">2</span> gkin meta u0b (k1 <span class="sc">+</span> k2) . <span class="fu">n</span><span class="op">},</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>       <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>k1<span class="op">,</span> <span class="sc">-</span><span class="dv">2</span> gkin meta k1 . <span class="fu">n</span> <span class="sc">+</span> meta u0b k1 . nb<span class="op">},</span> <span class="op">{</span><span class="dv">2</span> gkin meta<span class="sc">^</span><span class="dv">2</span> u0b<span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>k1<span class="op">,</span> k2<span class="op">},</span> <span class="op">{</span><span class="fu">n</span><span class="op">,</span> nb<span class="op">},</span> <span class="op">{</span><span class="fu">Hold</span><span class="op">[</span>SPD<span class="op">][</span><span class="fu">n</span><span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">0</span><span class="op">,</span> <span class="fu">Hold</span><span class="op">[</span>SPD<span class="op">][</span>nb<span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">0</span><span class="op">,</span> <span class="fu">Hold</span><span class="op">[</span>SPD<span class="op">][</span><span class="fu">n</span><span class="op">,</span> nb<span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">2</span><span class="op">},</span> <span class="op">{}]</span>;</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>topoEik2 <span class="ex">=</span> FCTopology<span class="op">[</span>mytopo79<span class="op">,</span> <span class="op">{</span>SFAD<span class="op">[{{</span>k2<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>k1<span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span><span class="dv">0</span><span class="op">,</span> k1 . nb<span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>k2<span class="op">,</span> <span class="sc">-</span>meta u0b k2 . nb<span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>k1 <span class="sc">+</span> k2<span class="op">,</span> <span class="sc">-</span>meta u0b (k1 <span class="sc">+</span> k2) . nb<span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> SFAD<span class="op">[{{</span>k1<span class="op">,</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        <span class="dv">2</span> gkin meta k1 . <span class="fu">n</span> <span class="sc">-</span> meta u0b k1 . nb<span class="op">},</span> <span class="op">{</span><span class="dv">2</span> gkin meta<span class="sc">^</span><span class="dv">2</span> u0b<span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}],</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>     SFAD<span class="op">[{{</span>k1 <span class="sc">+</span> k2<span class="op">,</span> <span class="dv">2</span> gkin meta u0b (k1 <span class="sc">+</span> k2) . <span class="fu">n</span> <span class="sc">-</span> meta u0b (k1 <span class="sc">+</span> k2) . nb<span class="op">},</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>       <span class="op">{</span><span class="dv">2</span> gkin meta<span class="sc">^</span><span class="dv">2</span> u0b<span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]},</span> <span class="op">{</span>k1<span class="op">,</span> k2<span class="op">},</span> <span class="op">{</span><span class="fu">n</span><span class="op">,</span> nb<span class="op">},</span> <span class="op">{</span><span class="fu">Hold</span><span class="op">[</span>SPD<span class="op">][</span><span class="fu">n</span><span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">0</span><span class="op">,</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">Hold</span><span class="op">[</span>SPD<span class="op">][</span>nb<span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">0</span><span class="op">,</span> <span class="fu">Hold</span><span class="op">[</span>SPD<span class="op">][</span><span class="fu">n</span><span class="op">,</span> nb<span class="op">]</span> <span class="ot">-&gt;</span> <span class="dv">2</span><span class="op">},</span> <span class="op">{}]</span>;</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>DataType<span class="op">[</span>meta<span class="op">,</span> FCVariable<span class="op">]</span> <span class="ex">=</span> <span class="cn">True</span>;</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>DataType<span class="op">[</span>u0b<span class="op">,</span> FCVariable<span class="op">]</span> <span class="ex">=</span> <span class="cn">True</span>;</span></code></pre></div>
<p>At first sight these two topologies are independent from each
other</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>FCLoopFindTopologyMappings<span class="op">[{</span>topoEik1<span class="op">,</span> topoEik2<span class="op">}]</span>;</span></code></pre></div>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Found }0\text{ mapping relations }</span></p>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Final number of independent topologies: }2</span></p>
<p>However, if we tell the code how some eikonal propagators can be
brought into a quadratic form, then an explicit mapping can be found</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>eikRule <span class="ex">=</span> <span class="op">{</span>SFAD<span class="op">[{{</span>k2<span class="op">,</span> <span class="sc">-</span>meta u0b k2 . nb<span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="dv">1</span><span class="op">}]</span> <span class="ot">-&gt;</span> SFAD<span class="op">[</span>k2 <span class="sc">-</span> meta u0b<span class="sc">/</span><span class="dv">2</span> nb<span class="op">]}</span></span></code></pre></div>
<p><span class="math display">\left\{\frac{1}{(\text{k2}^2-\text{meta}
\;\text{u0b} (\text{k2}\cdot \;\text{nb})+i \eta )}\to
\frac{1}{((\text{k2}-\frac{\text{meta} \;\text{u0b} \;\text{nb}}{2})^2+i
\eta )}\right\}</span></p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>eikMappings <span class="ex">=</span> FCLoopFindTopologyMappings<span class="op">[{</span>topoEik1<span class="op">,</span> topoEik2<span class="op">},</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    InitialSubstitutions <span class="ot">-&gt;</span> eikRule<span class="op">]</span>;</span></code></pre></div>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Found }1\text{ mapping relations }</span></p>
<p><span class="math display">\text{FCLoopFindTopologyMappings:
}\;\text{Final number of independent topologies: }1</span></p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>eikMappings<span class="op">[[</span><span class="dv">1</span><span class="op">]][[</span><span class="dv">1</span><span class="op">]][[</span><span class="dv">2</span> ;;<span class="op">]]</span></span></code></pre></div>
<p><span class="math display">\left\{\left\{\text{k1}\to
-\text{k1},\text{k2}\to \frac{1}{2} (\text{meta} \;\text{nb}
\;\text{u0b}-2
\;\text{k2})\right\},G^{\text{mytopo79}}(\text{n5$\_$},\text{n2$\_$},\text{n4$\_$},\text{n1$\_$},\text{n3$\_$},\text{n7$\_$},\text{n6$\_$}):\to
G^{\text{mytopo67}}(\text{n1},\text{n2},\text{n3},\text{n4},\text{n5},\text{n6},\text{n7})\right\}</span></p>
</body>
</html>
